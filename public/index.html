<style>
    /* ‡∏õ‡∏£‡∏±‡∏ö‡πÅ‡∏ï‡πà‡∏á‡∏õ‡∏∏‡πà‡∏° Auth Section ‡πÉ‡∏´‡∏°‡πà‡πÉ‡∏´‡πâ‡∏™‡∏ß‡∏¢‡∏á‡∏≤‡∏° */
    .auth-container { display: flex; align-items: center; gap: 15px; }
    
    .profile-info { 
        display: flex; align-items: center; gap: 10px; 
        background: #e0f2fe; padding: 8px 15px; border-radius: 12px;
        color: var(--deep-blue); font-weight: 600;
    }

    .btn-logout { 
        color: #f43f5e; text-decoration: none; font-size: 0.9rem; 
        font-weight: 600; cursor: pointer; transition: 0.3s;
        border: 1px solid #f43f5e; padding: 5px 12px; border-radius: 8px;
    }
    .btn-logout:hover { background: #f43f5e; color: white; }

    .btn-manage { 
        display: flex; align-items: center; gap: 5px;
        color: #6366f1; text-decoration: none; font-size: 0.9rem;
        font-weight: 600; padding: 5px 12px; border-radius: 8px;
        border: 1px solid #6366f1; transition: 0.3s;
    }
    .btn-manage:hover { background: #6366f1; color: white; }

    /* ‡∏õ‡∏£‡∏±‡∏ö‡πÅ‡∏ï‡πà‡∏á‡∏õ‡∏∏‡πà‡∏°‡πÉ‡∏ô‡∏ï‡∏∞‡∏Å‡∏£‡πâ‡∏≤‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤ */
    .btn-checkout {
        background: linear-gradient(135deg, #6366f1, #4f46e5);
        color: white; border: none; padding: 12px 25px;
        border-radius: 10px; font-weight: 600; cursor: pointer;
        box-shadow: 0 4px 15px rgba(99, 102, 241, 0.3);
    }
    .btn-checkout:hover { transform: translateY(-2px); opacity: 0.9; }
</style>

<script>
    // ‡∏≠‡∏±‡∏õ‡πÄ‡∏Å‡∏£‡∏î‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå‡πÅ‡∏•‡∏∞‡πÅ‡∏™‡∏î‡∏á‡∏õ‡∏∏‡πà‡∏°
    function checkAuth() {
        const user = JSON.parse(localStorage.getItem('user'));
        const authDisplay = document.getElementById('auth-display');
        const cartSection = document.getElementById('cart-section');

        if (user) {
            let manageBtn = user.role === 'admin' ? 
                `<a href="/admin.html" class="btn-manage"><i class="fa-solid fa-gear"></i> ‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏£‡∏∞‡∏ö‡∏ö</a>` : '';
            
            authDisplay.innerHTML = `
                <div class="auth-container">
                    <div class="profile-info">
                        <i class="fa-solid fa-circle-user"></i> ${user.username}
                    </div>
                    ${manageBtn}
                    <div class="btn-logout" onclick="logout()">Logout</div>
                </div>
            `;

            if (user.role === 'admin') cartSection.style.display = 'none';
        }
    }

    // ‡∏≠‡∏±‡∏õ‡πÄ‡∏Å‡∏£‡∏î‡∏£‡∏∞‡∏ö‡∏ö‡∏ä‡∏≥‡∏£‡∏∞‡πÄ‡∏á‡∏¥‡∏ô‡∏û‡∏£‡πâ‡∏≠‡∏°‡∏Å‡∏≤‡∏£‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô
    function showCartItems() {
        if (cart.length === 0) return Swal.fire('‡∏ï‡∏∞‡∏Å‡∏£‡πâ‡∏≤‡∏ß‡πà‡∏≤‡∏á‡πÄ‡∏õ‡∏•‡πà‡∏≤', '', 'info');
        const total = cart.reduce((sum, item) => sum + item.price, 0);
        
        Swal.fire({
            title: 'üõí ‡∏ï‡∏∞‡∏Å‡∏£‡πâ‡∏≤‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì',
            html: `
                <div style="text-align:left; max-height:300px; overflow-y:auto; margin-bottom:15px;">
                    ${cart.map((i, idx) => `
                        <div style="display:flex; justify-content:space-between; margin-bottom:10px; border-bottom:1px solid #eee; padding-bottom:5px;">
                            <span style="font-size:0.9rem;">${i.name}</span>
                            <div style="display:flex; align-items:center; gap:10px;">
                                <b>${i.price.toLocaleString()}‡∏ø</b>
                                <i class="fa-solid fa-trash" onclick="removeFromCart(${idx})" style="color:#f43f5e; cursor:pointer;"></i>
                            </div>
                        </div>
                    `).join('')}
                </div>
                <h3 style="text-align:right; color:var(--deep-blue);">‡∏¢‡∏≠‡∏î‡∏£‡∏ß‡∏°: ${total.toLocaleString()} ‡∏ø</h3>
            `,
            showCancelButton: true,
            confirmButtonText: '‡∏ä‡∏≥‡∏£‡∏∞‡πÄ‡∏á‡∏¥‡∏ô',
            cancelButtonText: '‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ï‡πà‡∏≠',
            confirmButtonColor: '#6366f1',
            cancelButtonColor: '#94a3b8'
        }).then((result) => {
            if (result.isConfirmed) {
                processPayment(total);
            }
        });
    }

    // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô‡∏Å‡∏≤‡∏£‡∏ä‡∏≥‡∏£‡∏∞‡πÄ‡∏á‡∏¥‡∏ô‡∏ó‡∏µ‡πà‡∏™‡∏°‡∏ö‡∏π‡∏£‡∏ì‡πå
    function processPayment(amount) {
        Swal.fire({
            title: '‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏Å‡∏≤‡∏£‡∏ä‡∏≥‡∏£‡∏∞‡πÄ‡∏á‡∏¥‡∏ô',
            text: `‡∏¢‡∏≠‡∏î‡∏ä‡∏≥‡∏£‡∏∞‡∏£‡∏ß‡∏°‡∏ó‡∏±‡πâ‡∏á‡∏™‡∏¥‡πâ‡∏ô ${amount.toLocaleString()} ‡∏ö‡∏≤‡∏ó`,
            icon: 'question',
            showCancelButton: true,
            confirmButtonText: '‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô',
            cancelButtonText: '‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å'
        }).then((res) => {
            if (res.isConfirmed) {
                // ‡∏à‡∏≥‡∏•‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏à‡πà‡∏≤‡∏¢‡πÄ‡∏á‡∏¥‡∏ô
                Swal.fire({
                    title: '‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£...',
                    timer: 1500,
                    didOpen: () => { Swal.showLoading() }
                }).then(() => {
                    Swal.fire({
                        title: '‡∏ä‡∏≥‡∏£‡∏∞‡πÄ‡∏á‡∏¥‡∏ô‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à!',
                        text: 'RockyStore ‡πÑ‡∏î‡πâ‡∏£‡∏±‡∏ö‡∏¢‡∏≠‡∏î‡∏ä‡∏≥‡∏£‡∏∞‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢‡πÅ‡∏•‡πâ‡∏ß ‡∏Ç‡∏≠‡∏ö‡∏Ñ‡∏∏‡∏ì‡∏ó‡∏µ‡πà‡πÉ‡∏ä‡πâ‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£‡∏Ñ‡∏£‡∏±‡∏ö',
                        icon: 'success'
                    }).then(() => {
                        cart = [];
                        document.getElementById('cart-count').innerText = '0';
                        window.location.reload();
                    });
                });
            }
        });
    }
</script>